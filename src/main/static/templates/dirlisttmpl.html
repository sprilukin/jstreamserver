<!--
  ~ Copyright (c) 2011 Sergey Prilukin
  ~
  ~ Permission is hereby granted, free of charge, to any person obtaining a copy
  ~ of this software and associated documentation files (the "Software"), to deal
  ~ in the Software without restriction, including without limitation the rights
  ~ to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  ~ copies of the Software, and to permit persons to whom the Software is
  ~ furnished to do so, subject to the following conditions:
  ~
  ~ The above copyright notice and this permission notice shall be included in
  ~ all copies or substantial portions of the Software.
  ~
  ~ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  ~ IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  ~ FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  ~ AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  ~ LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  ~ OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  ~ SOFTWARE.
  -->

<script id="dirListTmpl" type="text/template">
    <% _.each(files, function(file) { %>
    <li id="<%= file.id %>">
        <% if (file.directory) { %>
        <div class="directory">
        <% } else { %>
        <div class="file <% if (file.mediaInfo) { %>media<%}%> <% if (file.video) { %>video<%}%>">
        <% } %>
            <div>
                <span class="icon"></span>
                <span class="play-links-holder">
                    <a class="html5play" href="<%=file.url%>" title="<%=file.name%>"><%=file.name%></a>
                    <% if (file.video) { %>
                    <a class="download" href="<%=file.path%>" title="download <%=file.name%>">
                        <span class="icon download"></span>
                    </a>
                    <% } %>
                    <% if (file.mediaInfo) { %>
                    <span class="icon info"></span>
                    <% } %>
                </span>
                <span class="ajax-loader"></span>
            </div>
            <% if (file.mediaInfo) { %>
            <div class="mediaInfo">
                <div class="common">
                    <span class="label">bitrate: </span><span><%=file.mediaInfo.bitrate%></span>
                    <span class="label">duration: </span><span><%=file.mediaInfo.duration%></span>
                <div class="common">
                <% if (file.mediaInfo.videoStreams.length > 0) { %>
                <div class="video">
                    <span class="label">video: </span>
                    <span><%=file.mediaInfo.videoStreams[0].encoder%></span>
                    <span>, <%=file.mediaInfo.videoStreams[0].resolution%></span>
                    <% if (file.mediaInfo.videoStreams[0].language) { %>
                    <span>, (<%=file.mediaInfo.videoStreams[0].language%>)</span>
                    <% } %>
                </div>
                <% } %>
                <% if (file.mediaInfo.audioStreams.length > 0) { %>
                <div class="audio">
                    <span class="label">audio: </span>
                    <% _.each(file.mediaInfo.audioStreams, function(stream, index) { %>
                    <span class="label">[</span>
                    <span>
                        <% if (file.video) { %>
                        <a href="<%=file.url%>&stream=<%=stream.id%>" title="Play [<%=file.name%>] with audio stream <%=index%>">
                        <% } %>
                        <%=stream.encoder%>, <%=stream.frequency%>, <%=stream.channels%>
                        <% if (stream.language) { %>, (<%=stream.language%>)<% } %>
                        <% if (stream.defaultStream) { %>, (default)<% } %>
                        <% if (file.video) { %>
                        </a>
                        <% } %>
                    </span>
                    <span class="label">] </span>
                    <% }) %>
                </div>
                <% } %>
            </div>
            <% } %>
        </div>
    </li>
    <% }) %>
</script>
